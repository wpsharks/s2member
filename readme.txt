=== s2Member ‚Äì Excellent for All Kinds of Memberships, Content Restriction Paywalls & Member Access Subscriptions ===

Plugin Name: s2Member Framework
Plugin URI: https://s2member.com/
Tags: membership, content restriction, paid subscriptions, members only, paid access
Version: 250525
Stable tag: 250525
Tested up to: 6.9-alpha-60248
Requires at least: 4.2
Requires PHP: 5.6.2
Tested up to PHP: 8.3
License: GNU General Public License v2 or later.
Contributors: WebSharks, JasWSInc, raamdev, clavaque, eduan
Author: s2Member
Author URI: https://s2member.com/
Donate link: https://s2member.com/donate/
Beta link: https://s2member.com/beta-testers/
Forum URI: https://s2member.com/r/forum/
Privacy URI: https://s2member.com/privacy-policy/
Changelog URI: https://s2member.com/changelog/
Video Tutorials: https://s2member.com/r/s2member-videos/
Knowledge Base: https://s2member.com/kb/
More Updates: https://s2member.com/category/news-updates/
Newsletter: https://s2member.com/r/subscribe/
PayPal Pro Integration: https://s2member.com/r/pp-account-types/
Text Domain: s2member
Domain Path: /src/includes/translations

‚ù§Ô∏è Excellent membership plugin! Easy, quick, flexible. Monetize your site with memberships and subscriptions. Protect content instantly and securely.

== Description ==

‚ù§Ô∏è **Excellent membership plugin!** Over 15 years of experience, development, releases... Still going and growing!

**Start your membership profits!** Build your tribe, gather your followers, enroll your students, bring in your clients!

üíµ Enjoy the benefits of getting paid repeatedly for access to your site!

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Brilliant** "So glad I found this. It works brilliantly for our needs... love the seamless integration with PayPal. Everything we need. Thank you so much for creating this!" -[zarverk2000](https://wordpress.org/support/topic/brilliant-1268/)_

= The best way to make money from your WordPress site! =

ü§© Sell **unlimited memberships**, turn free subscribers into members (_subscriber to member ‚Üí s. 2 member ‚Üí s2Member_), with a single payment or recurring payments subscriptions.

**Easy and quick to use.** Protect your membership content in a moment, and a moment later be ready to get payments for member access! 

**Easy to configure and very flexible.** Protect the whole site, nothing, or just parts, even member files for paid downloads!

üëâ Install s2Member now and **make money!** üòÄ

https://youtu.be/qlKn-I-0W6U

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**So much capacity & great support** "I‚Äôm a novice and was able to quickly figure it out. When I got stuck I go to the support forum and Cristian is there with a quick answer to get me going again." -[blueruck](https://wordpress.org/support/topic/so-much-capacity-great-support/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**The very best plugin and support service** "Great plugin, neat, easy to configure, and with interesting security features.  A special mention to Cristian whose support is awesome, fast, clear even to free members like myself" -[aflorarte](https://wordpress.org/support/topic/the-very-best-plugin-and-support-service/)_

**Packed with features**, but not required to use them all, just those you want. Some of them:

‚û°Ô∏è Member user levels and custom access capabilities
‚û°Ô∏è Membership content protection (post, page, category, tag, etc)
‚û°Ô∏è Protect anything served by WP (post types, URLs)
‚û°Ô∏è Member file protection (sell downloads)
‚û°Ô∏è Prevent member account sharing (limit IPs, simultaneous logins)
‚û°Ô∏è Protect accounts (limit failed login attempts)
‚û°Ô∏è Cool security/trust badge with your domain
‚û°Ô∏è PayPal Standard buttons for membership payments (more in Pro)
‚û°Ô∏è Automatic member access demotion at end of paid access time
‚û°Ô∏è Tracking software integration (affiliates, etc)
‚û°Ô∏è Email list services (Mailchimp, etc)
‚û°Ô∏è Notifications (signups, payments, etc)
‚û°Ô∏è Integrate with bbPress, BuddyPress for member communities
‚û°Ô∏è Compatible with any well coded theme (Elementor, Divi, etc)
‚û°Ô∏è Customize the WP login/registration look
‚û°Ô∏è Custom redirection after member login
‚û°Ô∏è Create custom profile fields for member accounts
‚û°Ô∏è Customize the user welcome email
‚û°Ô∏è And more!

üëâ Install and start using s2Member now! ü§©

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Very Powerful Membership Plugin** "This membership plugin does a lot and has many, many configuration options to achieve whatever you want... I received extremely quick and reliable support." -[liltrucks](https://wordpress.org/support/topic/very-powerful-membership-plugin/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Simple, Compatible, Secure, and Versatile!** "We are seriously impressed with this plugin and we highly recommend it... We have not found ANY limitations to what we are trying to accomplish... a very smooth process... straight-forward and user-friendly!... exceeded our expectations!" -[tips4gamers](https://wordpress.org/support/topic/simple-compatible-secure-and-versatile/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Excellent plugin** "This plugin does everything it says on the box. It does it well... the functionality is absolutely spot on. The developers/maintainers are also active and helpful. Totally recommended!" -[richardfoley](https://wordpress.org/support/topic/excellent-plugin-5188/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Best Membership Plugin I‚Äôve Used** "I switched to s2 Member around 3 years ago after trying a few plugins. I found these other plugins inflexible and difficult to configure... Well worth investigating if you want a robust membership solution." -[rnwhalley](https://wordpress.org/support/topic/best-membership-plugin-ive-used/)_

ü§ñ Not needed to know any PHP code or be a developer. Only code needed is copy-paste wp shortcodes, like for the paypal buttons... But is also developer-friendly to customize your installation if wanted.

= Some reasons to get s2Member Pro =

‚úÖ Membership content dripping
‚úÖ Stripe, PayPal Pro, Authorize.Net, ClickBank
‚úÖ On-site one-step checkout with pro-forms (Stripe, PayPal, Auth.Net)
‚úÖ Unlimited membership levels
‚úÖ Membership renewal reminder emails
‚úÖ Single-step member registration and payment with pro-forms
‚úÖ Custom redirection after payment
‚úÖ Coupon codes and gift/redemption codes
‚úÖ Custom member offer redirections after login
‚úÖ Pro API for new integrations
‚úÖ Public members directory
‚úÖ Members bulk import/update/exporter
‚úÖ Multisite network support
‚úÖ Login and registration forms to use in pages/posts
üëâ [Click here for more](https://s2member.com/features/) üôÇ

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**The Best Membership Plugin** "I have built with most Membership plugins and literally dozens using S2 Pro and I can tell you, bar none it is the best of all of them. Extremely powerful, anything you might want to do it can do... I highly recommend you try it out." -[antwoords](https://wordpress.org/support/topic/the-best-membership-plugin-5/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Excellent plugin & top support** "We‚Äôve used s2member pro on a few projects now & find it has met all our membership needs. Most impressive has been the support. Excellent communication, knowledgeable, friendly and super patient üôÇ" -[aaee6](https://wordpress.org/support/topic/excellent-plugin-top-support-3/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Awesome Support** "I‚Äôve been using s2Member for 9 years... Amazing support of a high-end plugin and much appreciated. This is one of the reasons I stick with s2Member. Support has always been great!" -[graphichome](https://wordpress.org/support/topic/awesome-support-712/)_

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê _**Wonderful Support** "Above and beyond. I‚Äôve used this plugin for over ten years with various clients and whenever I need help, they‚Äôve helped find a solution." -[germars](https://wordpress.org/support/topic/wonderful-support-68/)_

The free s2Member Framework integrates with PayPal Website Payments Standard (also free). Sell "Buy Now" or Membership access to your site. Restrict access to Roles, Capabilities, Posts, Pages, or anything else in WordPress.

Protect your WordPress Posts, Pages, Tags, Categories, URIs, BuddyPress, bbPress, and even portions of content within Posts, Pages, themes, plugins. **Easily configurable and highly extensible.** You can even protect downloadable files and streaming audio/video. Store files locally, or use s2Member's integration with Amazon S3/CloudFront.

s2Member is powered almost entirely by WordPress shortcodes, making advanced integrations quick and easy. Sell recurring (or non-recurring) subscriptions with lots of flexibility. Or sell "Buy Now" membership access in various ways. You can also sell specific Posts/Pages, sell member access to file downloads, or sell members Custom Capabilities that provide highly configurable access to specific portions of your content.

üëâ Install now s2Member and **start making money!** üòÄ

== Installation ==

**NOTICE:** For help with s2Member Pro, please use [our forum](http://s2member.com/r/forum/).

= s2Member is very easy to install =

Just like any other normal plugin:

- From the WP Admin's [Plugins Add New Screen](https://wordpress.org/support/article/plugins-add-new-screen/). 
- Or via FTP upload the `s2member` folder from the zip to your `/wp-content/plugins/` directory.
- Activate it from **Plugins** page in your WordPress Admin.

Here's a [quick-start video](https://www.youtube.com/watch?v=qlKn-I-0W6U) for a simple basic setup to get you started.

= See also =

[Detailed installation/upgrade instructions](http://s2member.com/installation/).

= Is s2Member compatible with Multisite Networking? =

Yes, requires s2Member Pro for Unlimited Sites. After you enable Multisite Networking, with s2Member Framework and Pro active, navigate to `s2Member ‚Üí Multisite (Config)` in the Dashboard on your Main Site.

== Screenshots ==

1. s2Member Screenshot #1
2. s2Member Screenshot #2
3. s2Member Screenshot #3
4. s2Member Screenshot #4
5. s2Member Screenshot #5
6. s2Member Screenshot #6
7. s2Member Screenshot #7

== Frequently Asked Questions ==

**NOTICE:** For help with s2Member Pro, please use [our forum](http://s2member.com/r/forum/).

= Is s2Member compatible with Multisite Networking? =

Yes, s2Member Pro for Unlimited Sites is compatible with Multisite Networking. After you enable Multisite Networking, with s2Member Framework and Pro enabled, navigate to `s2Member ‚Üí Multisite (Config)` in the Dashboard on your Main Site.

= Where can I find more information? =

* s2Member FAQs: <http://s2member.com/faqs/>
* Knowledge Base: <http://s2member.com/kb/>
* Video Tutorials: <http://s2member.com/videos/>
* Community: <http://s2member.com/r/forum/>
* Codex: <http://s2member.com/codex/>

= Translating s2Member =

Please see: <http://s2member.com/r/translations/>

== Upgrade Notice ==

= v250525 =

(Maintenance Release) Upgrade immediately.

== Changelog ==

= v250525 =

- (Framework & Pro) **Fix**: Some translations were being applied too early, causing PHP notices since WP 6.7. Now all translations are only loaded at the `init` hook or later. See [thread 12813](https://f.wpsharks.com/t/12813)

= v250511 =

- (Framework) **Fix**: Improved the admin notices handler to prevent a PHP 8.1+ error in rare cases when the data wasn't an array as expected.

- (Framework) **Enhancement**: Added sanitization to the admin notices handler for improved safety.

- (Framework & Pro) **Fix**: Updated all uses of preg_split() with `-1` instead of `NULL` as the limit to prevent PHP 8.1+ deprecation warnings.

- (Pro) **Fix**: Fixed an s2Member-List database query with a typo that prevented some custom searches from working as expected.

- (Pro) **Fix**: Removed a check in Stripe pro-forms that blocked using the same details for trial and regular payments for subscriptions. See [thread 12818](https://f.wpsharks.com/t/12818).

= v250502 =

- (Pro) **Enhancement**: Added optional fallback behavior for missing IPN Signup Vars during Stripe webhook processing. When enabled, s2Member will generate a makeshift IPN vars array if none are stored for the user. This helps support migrated or manually imported subscriptions. The setting is available under _s2Member Pro > Stripe Options > Stripe Webhook/IPN Integration_. See [thread 11334](https://f.wpsharks.com/t/11334).

- (Framework) **UI**: Removed admin notice about Easter promo for Pro add-on.

= v250424 =

- (Framework) **Enhancement**: Added additional sanitation/validation to the Logs Viewer, although only Administrators have access to it.

= v250419 =

- (Pro) **Enhancement**: Improved the new coupon code limit per user which prevents a user from applying a coupon code unlimited times, Instead of single use, it can now be limited to more uses, e.g. 3. It's been renamed from "User Once" to "User Max", max number of times a user can use that coupon. This is optional and leaving it blank will give the default "no limit".

- (Pro) **Enhancement**: Improved validation of the template attribute in the s2Member-List-Search-Box shortcode.

- (Framework) **UI**: Temporary admin notice about Easter promo for Pro add-on at 20% off.

= v250214 =

- (Pro) **Enhancement**: Improved coupon usage logging for better tracking.

- (Pro) **Enhancement**: Added a new single-use per user option for coupons. Thanks to Carl Borsani for sponsoring this.

- (Pro) **Enhancement**: Coupons can now be limited to specific pro-forms. Thanks to Carl Borsani for sponsoring this.

- (Framework) **Fix**: s2Get can now handle s2Member‚Äôs custom profile fields. Thanks to Gerard Earley for reporting this.

- (Framework) **Fix**: Updated the admin notice about the PayPal button encryption setting. 

- (Pro) **Enhancement**: Improved data handling in the Remote Operations API. Props to Istv√°n.

- (Pro) **Enhancement**: Improved validation of the template attribute in pro-forms and s2Member-List shortcodes. Props to Istv√°n.

= v241216 =

- (Framework) **Enhancement**: Added extra attribute validation to the s2Get shortcode. Props to wcraft.

- (Framework) **Enhancement**: Improved New User email preparation before send. Props to Hakiduck.

= v241114 =

- (Framework & Pro) **Fix**: An error could happen on PHP8 during Pro activation. Fixed in this release.

- (Framework) **Enhancement**: s2Get shortcode can now be used to show s2's current user constants. E.g. `[s2Get constant="S2MEMBER_CURRENT_USER_DISPLAY_NAME" /]` _WP Admin > s2Member > API / Scripting > s2Member PHP/API Constants_

= v240325 =

- (Framework) **Fix**: Some sites were getting a warning from v240315's restriction improvement when the WP REST request doesn't include a type or ID. Fixed in this release.See [thread 11347](https://f.wpsharks.com/t/11347)

- (Pro) **Enhancement**: Checkout success redirection URLs are now validated as safe with WordPress' _wp_validate_redirect_. To use a domain different than the site's, it can be allowed with wp's filter [allowed_redirect_hosts](https://developer.wordpress.org/reference/hooks/allowed_redirect_hosts/).

- (Framework) **Enhancement**: Additional validation to prevent an invalid s2Member Level role during registration. 

= v240315 =

- (Framework) **Enhancement**: Improved access restrictions applied to WP REST requests.

= v240218 =

- (Framework) **Fix**: PayPal button encryption default changed to "disabled".

- (Framework) **Fix**: Mailchimp interest groups integration wasn't working correctly all the time. Fixed in this release.

= v230815 =

- (Framework) **Fix**: Added some missing functions to the list of conditionals allowed by default for s2If (e.g. `current_user_days_to_eot_less_than`, `current_user_gateway_is`). See also: https://s2member.com/kb-article/s2if-simple-shortcode-conditionals/#toc-5bb69568

- (Pro) **Enhancement**: New s2If whitelist option for custom conditional functions to be allowed. _s2Member Pro > Restriction Options > Simple Shortcode Conditionals > Whitelist_

- (Framework) **Enhancement**: Handle s2If conditional problems more gracefully. Instead of giving an error that prevents loading the rest of the page, it now just doesn't display that s2If's block, and enters a message in the error log (e.g. `/wp-content/debug.log`).

- (Framework & Pro) **Enhancement**: Prevent output from s2If conditions, only _true_ or _false_.

- (Framework) **UI**: Update the Mailchimp example from `Group Title` to `Group Category`, to match Mailchimp's current name in their settings. _s2Member > API / List Servers > Mailchimp_

= v230808 =

- (Framework) **Fix**: Potential security issue under rare circumstances. Fixed in this release.

- (Framework) **Fix**: Mailchimp's groups/interests were not transitioning correctly with the updated integration. Fixed in this release.

- (Framework) **UI**: Added a notice about PayPal giving trouble with encrypted buttons recently, recommending to not encrypt them for now. You may need to disable button encryption, and allow non-encrypted payments. _s2Member > PayPal Options > Account Details > Button Encryption_ 
 
- (Framework) **UI**: Brought back the "Expand All" and "Collapse All" buttons for the admin panels. See [thread 10796](https://f.wpsharks.com/t/10796)

- (Framework) **UI**: Updated the link to the PayPal IPN configuration.

- (Framework) **UI**: Added link to PayPal's IPN History page. _s2Member > PayPal Options > PayPal IPN > More Information_

- (Pro) **Fix**: Stripe's billing update pro-form gave an error sometimes. Fixed in this release.  See [thread 10752](https://f.wpsharks.com/t/10752)

= v230530 =

- (Framework) **Enhancement**: Updated the Mailchimp integration to v3 of their API.  I made it so you shouldn't need to change anything, it should work with your existing configuration. Still worth doing a test or checking that things are normal after the update, and report any issues you notice. See: [thread 10666](https://f.wpsharks.com/t/10666)

= v230504 =

- (Pro) **Fix**: Stripe subscriptions weren't using customer cards updated with the Billing Update pro-form. The subscription saved the first card, instead of defaulting to the card in the customer's profile. This release fixes that. The card is not added to a new subscription anymore, only to the customer's profile, and updating his profile's card with the Billing Update pro-form, will also update the subscription so it uses it. Thanks to Jim Antonucci for his help with this.

- (Pro) **Enhancement**: The Stripe Billing Update pro-form now includes a field for the cardholder's name (i.e. Name On Card). Adding the name to the card will improve successful subscription charges. Thanks to Andy Johnsen for the idea.

= v230425 =

- (Framework) **Fix**: Fixed domain name format validation for custom profile fields.

- (Framework) **Fix**: Fixes to markdown parser for PHP8 compatibility.

- (Framework) **Fix**: Fixed HTML near AWeber's API key field.

= v230413 =

- (Pro) **Bug Fix**: An error could happen on PHP8 during Pro installation in a multisite network. Fixed in this release.

- (Framework) **Bug Fix**: An error could happen on PHP8 when saving an edited user profile. Fixed in this release.

- (Framework) **UI Enhancement**: In the List Servers admin page, removed mentions of the AWeber email parser, which isn't available any more. 

= v221103 =

- (Framework) **Bug Fix**: Removed latest changes to gateway notification and return handlers, that were causing difficulties with member access in some scenarios. 

= v221031 =

- (Framework) **Bug Fix**: Fix PayPal IPNs being ignored because a bug in the last release. After updating to this release, you may want to [review your latest IPNs](https://www.paypal.com/merchantnotification/ipn/history) since updating to v221028, and re-send them from PayPal. See [thread 10208](https://f.wpsharks.com/t/10208)

= v221028 =

- (Framework) **Fix**: Initialized some array keys to prevent PHP warnings in PayPal notify and return files. Thanks Greg M. for your help.

- (Framework) **UI**: Widened the Logs viewer. Thanks Sim. See [thread 10064](https://f.wpsharks.com/t/10064)

- (Framework) **UI**: Framework auto-update is now allowed when Pro add-on installed.

- (Pro) **UI**: The Pro updater now shows when a newer version available, not just when required.

= v220925 =

- (Pro) **UI Enhancement**: In ClickBank Options admin page, added note about keeping IPN encryption disabled.

- (Pro) **Enhancement**: Removed ClickBank's name from the notify, return, and success URLs, replaced with just `cb`. Kudos to Eduardo for telling me about this. See [thread 9910](https://f.wpsharks.com/t/9910)

- (Pro) **Enhancement**: Added a PayPal payment request ID to help prevent random/rare PayPal duplicate charges. Kudos to Nathan for his help. See [thread 7999](https://f.wpsharks.com/t/7999/27)

- (Framework) **UI Enhancement**: Admin page panels widened for larger displays.

- (Framework) **UI Enhancement**: Simplified Getting Started and Getting Help admin pages.

- (Framework) **UI Enhancement**: In PayPal Options admin page, updated paths and links to PayPal settings.

- (Framework) **Bug Fix**: Removed the Security Badge's link to the old Flash powered page on s2Member's site.

- (Pro) **UI Enhancement**: Small improvements to the Pro upgrader.

= v220809 =

- (Framework) **Enhancement**: New `current_user_days_to_eot_less_than` function for conditionals. Useful when you want to show a message to a user on his last days of access before the EOT time in his profile. E.g. `[s2If current_user_days_to_eot_less_than(31)]Please renew your membership[/s2If]`. Kudos to Felix for his help, see [post 6783](https://f.wpsharks.com/t/6783).

= v220421 =

- (Framework & Pro) **Enhancement**: Improved PHP compatibility to 8.1.

- (Framework) **UI Fix**: `More Updates` link fixed.

= v220318 =

- (Framework) **Enhancement**: New `current_user_gateway_is` function for conditionals. Useful for sites using more than one gateway. E.g. `[s2If current_user_gateway_is(stripe)] ...`

- (Pro) **UI Fix**: Removed "Image Branding" setting from s2's Stripe options, not used in current integration.

= v210526 =

- (s2Member Framework & Pro) **UI Enhancement**: Started improving the admin interface. Lightened up the colors, and changed the layout a little bit. 

- (s2Member Framework) **UI Enhancement**: Added title tag to buttons to manage custom profile fields in admin, to improve use with screen-reader. [Thread 8836](https://f.wpsharks.com/t/8836/12)

- (s2Member Pro) **UI Fix**: Fixed typo in pro-form `rrt` attribute description. [Issue 1204](https://github.com/wpsharks/s2member/issues/1204)

- (s2Member Framework) **Bug Fix**: Registration Date sometimes wasn't formatted correctly with the s2Get shortcode. [Thread 8730](https://f.wpsharks.com/t/8730)

= v210208 =

- (s2Member Pro) **Enhancement**: In the Stripe integration, cancelling a subscription in the last minutes of a period, may cause the invoice for the new period to remain there and still be charged later. Now s2Member Pro attempts to find a draft or open invoice for the subscription being cancelled, and void it. Thanks Alan for reporting it. See [post 8386](https://f.wpsharks.com/t/8098).

- (s2Member Pro) **UI Enhancement**: Improved Stripe pro-form error message when trying to create a subscription with a bad card. Thanks everyone that reported it. See [issue #1184](https://github.com/wpsharks/s2member/issues/1184), [post 6043](https://f.wpsharks.com/t/6043), and [post 8386](https://f.wpsharks.com/t/8386).

- (s2Member Pro) **Enhancement**: Added the new action hooks `ws_plugin__s2member_pro_before_stripe_notify_event_switch` and `ws_plugin__s2member_pro_after_stripe_notify_event_switch` in the Stripe endpoint to allow customizations, e.g. new event handlers.

- (s2Member Pro) **UI Fix**: Removed some leftover mentions of Bitcoin support in Stripe's options.

- (s2Member Pro) **UI Fix**: Removed a couple of deprecated shortcode attributes from the documentation for Stripe's pro-form, leftovers from the old integration. Kudos to Debbie for bringing my attention to them. See [post 8053](https://f.wpsharks.com/t/8053).

- (s2Member Framework) **UI Fix**: Fixed some broken links and video players in the admin pages.

- (s2Member Framework) **Bug Fix**: Resolved a warning given when changing users role in bulk from the WP Admin > Users page.

- (s2Member Server Scanner) **Bug Fix**: Updated the [Server Scanner](https://s2member.com/kb-article/server-scanner/) to remove some outdated warnings.

= v201225 =

- (s2Member Framework) **Bug Fix**: View Password icon WP's login page was not displaying correctly. Kudos to Beee4life for reporting it. See [issue #1187](https://github.com/wpsharks/s2member/issues/1187)

- (s2Member Framework and Pro) **Enhancement**: Refactored PHP's deprecated _create_function_ with anonymous functions. Kudos to Berry for reporting it, see [post 6069](https://f.wpsharks.com/t/6069) 

- (s2Member Framework) **Bug Fix**: Added a check for empty return variable before trying to use it in paypal-utilities.inc.php.

- (s2Member Framework) **Bug Fix**: Added checks for undefined indexes before trying to use them in paypal-return-in-subscr-or-wa-w-level.inc.php.

- (s2Member Framework) **Bug Fix:** Added a check for undefined index before using it to define a couple of s2 constants. Kudos to Berry for reporting it, see [post 8181](https://f.wpsharks.com/t/8181/) 

- (s2Member Pro) **Bug Fix**: s2's payment notification when creating a Stripe subscription, was being sent twice. Added a check to ignore the webhook for the subscription's on-session first payment; s2's webhook endpoint is for off-session events. 

- (s2Member Framework) **Enhancement**: Added a new hook for the payment notification on subscription creation or buy now payments.

- (s2Member Pro) **Bug Fix**: Stripe paid trials were accumulating on failed payment attempts, causing a larger charge when it finally succeeded. Kudos to Alan for his help through the many attempts to fix this one, see [post 7002](https://f.wpsharks.com/t/7002).

- (s2Member Pro) **Enhancement**: Stripe duplicate payments were happening randomly to a few site owners, apparently from bad communication between their server and Stripe's. Added idempotency to prevent duplicates. Kudos to Alan and everyone in the forum that reported and gave details on this behavior, see [post 7002](https://f.wpsharks.com/t/7002)

= v200301 =

- (s2Member Pro) **Enhancement:** Added "Powered by Stripe" to Stripe pro-form's payment card field. Kudos to Josh, see [post 6716](https://f.wpsharks.com/t/6716).

- (s2Member Pro) **Bug Fix:** Stripe subscription cancellations were not happening when they should. This release updates the API integration for it and fixes that behavior. Kudos to Matt for reporting it, see [post 6909](https://f.wpsharks.com/t/6909).

- (s2Member Pro) **Bug Fix:** Updating the card with Stripe's pro-form sometimes gave an incorrect "missing billing method" error. Kudos to Corey, see [post 7058](https://f.wpsharks.com/t/7058).

- (s2Member Pro) **Small fix:** Removed Bitcoin mention next to Stripe in Gateways list. Missed it in [v191022](https://s2member.com/s2member-v191022-now-available/).

= v200221 =

- (s2Member Pro) **Bug Fix:** In some rare cases, another plugin loaded Stripe's class before s2Member, so when s2 tried loading it there'd be an error. This release fixes the check for the class before trying to load it. See [issue #1170](https://github.com/wpsharks/s2member/issues/1170)

  **Note:** s2Member won't have control over what version of the Stripe SDK was loaded by the other plugin. You'll need to get that other plugin to have an up-to-date version. If you don't have another plugin loading Stripe, this is not relevant to you.

- (s2Member Pro) **Bug Fix:** When using a 100% off coupon, requiring no payment, the Stripe pro-form was still loading the card field and requiring it, preventing the free signup. That's fixed in this release. See [issue #1171](https://github.com/wpsharks/s2member/issues/1171)

- (s2Member Pro) **Bug Fix:** The Stripe pro-form, when given an invalid card, didn't give a clear error message for it, and instead just "invalid parameter". Now it shows the correct card error, making it possible for the customer to try a different card to complete the payment.

- (s2Member Pro) **Feature Update:** The Indian Rupee was added to the list of currency symbols.

- (s2Member Pro) **Feature Enhancement:** The s2Member Pro add-on, not being a regular plugin was not uploadable via the WP plugin manager. This made it necessary to FTP, which is complicated for some site owners. In this release I made it possible for the plugin manager to upload or remove the Pro add-on.

  **Note:** It still is not a regular plugin. The activation link or status in the plugins manager is irrelevant, but I couldn't find how to remove it. s2Member Pro activates automatically when its version matches the Framework's, and it'll be mentioned next to the Framework's version in the plugins manager.

= v191022 =

- (s2Member Pro) **Feature Enhancement:** The Stripe pro-forms can now handle 3D Secure 2 for [Strong Customer Authentication](https://stripe.com/guides/strong-customer-authentication), as required by the new European regulation that came into effect recently. Props to those in the beta testing group, especially Brice and Felix. See [thread 5585](https://f.wpsharks.com/t/5585/).

- (s2Member Pro) **Feature Enhancement:** The Stripe pro-form now has the card field inline, instead of opening a modal to enter it. Before it required clicking the link to open the modal, enter the card details, submit that, and then submit the pro-form. Now you enter the card details as part of the pro-form. See [issue #588](https://github.com/wpsharks/s2member/issues/588).

- (s2Member Pro) **Stripe Integration Updates:** Upgraded the Stripe PHP SDK from v1.18 to v7.4.0, and the API from 2015-07-13 to 2019-10-08. Upgraded the integration from the Charges API to the latest Payment Intents API. Upgraded the card input from the old Stripe Checkout modal, to the new Stripe.js and Elements. 

- (s2Member Pro) **Optimization:** Stripe's JavaScript now only gets included if the page has a Stripe pro-form.

- (s2Member Pro) **Removed Stripe Bitcoin**: Stripe [dropped Bitcoin](https://stripe.com/blog/ending-bitcoin-support) last year, it's not available anymore. This update removes the Bitcoin options and mentions from the s2 admin pages.

- (s2Member Pro) **Bug Fix:** Subscriptions without at trial were showing a "trialing" status in Stripe for the first period. This behavior has now been solved. It will only say trialing when you set a trial period (free or paid) in your Stripe pro-form shortcode. See [issue #1052](https://github.com/wpsharks/s2member/issues/1052).

- (s2Member Pro) **Bug Fix:** The Stripe pro-form installments via the `rrt` shortcode attribute were charging an extra payment before ending the subscription. There was an error in the time calculation for this. This is solved in this release. Props to Brice. See [thread 5817](https://f.wpsharks.com/t/5817/).

- (s2Member Pro) **Bug Fix:** Some payments through the Stripe pro-form were creating a new Stripe customer when the user was already a customer. The Stripe customer ID was not being saved correctly in the user's profile. This is solved in this release. Props to demeritcowboy for reporting it.

= v190822 =

- (s2Member) **PayPal Integration Update:** PayPal deprecated the subscription modification button. Using the old possible values for this, now gives an error on PayPal's site. This button has been removed from the PayPal Standard integration in s2Member. Props to Tim for reporting it, see [forum thread 5861](https://f.wpsharks.com/t/5861), and [issue #1157](https://github.com/wpsharks/s2member/issues/1157).

- (s2Member) **Bug Fix:** PayPal would sometimes return the customer without the Custom Value expected by s2Member, incorrectly triggering an error. A small delay has now been added when needed to wait for PayPal to provide the missing value, so that the customer is met with the correct success message on return. Props to Josh Hartman for his help. See [forum thread 5250](https://f.wpsharks.com/t/5250).

- (s2Member) **Bug Fix:** Google's URL shortening service has been [discontinued](https://developers.googleblog.com/2018/03/transitioning-google-url-shortener.html). The s2Member integration with it was removed in this release. Props to Felix Hartmann for reporting it.

- (s2Member) **Feature Enhancement:** The popular URL shortening services have been abused in spam emails, and this can cause your site's emails with shortened signup URLs to end up in the spam folder. It's now possible to disable URL shortening when trying to avoid this problem. Props to Felix Hartmann for suggesting it. See [forum thread 5697](https://f.wpsharks.com/t/5697).

- (s2Member Pro) **New Feature:** It is now possible to use a custom URL shortener other than the defaults in the s2Member Framework. This is particularly useful to use [YOURLS](http://yourls.org/) for your links, making them unique to your site, looking more professional and avoiding the spam filters issue mentioned above. For more info see this [forum post](https://f.wpsharks.com/t/5697/19).

= v190617 =

- (s2Member Pro) **Authorize.Net Hash Upgrade:** Authorize.Net [announced](https://support.authorize.net/s/article/MD5-Hash-End-of-Life-Signature-Key-Replacement) the end-of-life for their MD5 Hash in favor of their new SHA512 Signature Key. Support for this has been added to s2Member Pro. The MD5 Hash is not provided by Authorize.Net any more, so the field for it in s2Member has been disabled. Props @krumch for his work. For further details see [forum thread 5514](https://f.wpsharks.com/t/5514).

  **Note:** For those that already used the MD5 Hash in their configuration, it is kept there and will keep working while Authorize.Net accepts it, which will not be much longer. It's important to update your integration with the new Signature Key. Once you have your Signature Key in the s2Member configuration, it will be favored over the old MD5 Hash._

- (s2Member Pro) **Bug Fix:** The multisite patch for `wp-admin/user_new.php` wasn't finding the code to replace because of changes in the latest releases of WordPress. It has now been updated, as well as the instructions in the Dashboard for those that prefer to apply it manually. Props @crazycoolcam for reporting it. For further details see [Issue #1132](https://github.com/wpsharks/s2member/issues/1132).

  **Note:** If you already had patched this file in the past, it's recommended that you remove the previous patch restoring it to the original file, and let s2Member Pro patch it again now, otherwise you risk getting it patched over the previous one and ending up with errors. After the new patch, please review that file to verify that it's correct._

- (s2Member Pro) **Bug Fix:** The search results for `s2Member-List` were not being ordered as specified in the `orderby` attribute when this was a field from the `usermeta` table in the database, e.g. `first_name`, `last_name`. This is now fixed and working correctly. Props to @stevenwolock for reporting it. For further details see [Issue #1103](https://github.com/wpsharks/s2member/issues/1103).

- (s2Member) **WP 5.2 Compat. Enhancement:** s2Member has been tested with WP up to 5.2.2-alpha. With `WP_DEBUG` enabled, only one "notice" was found. In `wp-login.php` it said 'login_headertitle is deprecated since version 5.2.0! Use login_headertext instead.' This release now uses `login_headertext` and doesn't get that notice anymore. Props Azunga for reporting it. See [forum thread 5962](https://f.wpsharks.com/t/5962).

You can find the [full changelog here](https://s2member.com/changelog/).
